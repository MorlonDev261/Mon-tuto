<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutoriel React, Redux & Vite</title>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism-tomorrow.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 0;
      background-color: #f9f9f9;
      color: #333;
    }
    header {
      background: #4CAF50;
      color: #fff;
      padding: 1rem 0;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    pre {
      background: #f4f4f4;
      padding: 10px;
      border-left: 4px solid #4CAF50;
      overflow-x: auto;
      position: relative;
    }
    .section {
      margin-bottom: 20px;
    }
    button.copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 2px 5px;
      cursor: pointer;
      font-size: 12px;
      border-radius: 4px;
    }
    button.copy-btn:hover {
      background-color: #45a049;
    }
    .code-block {
      position: relative;
    }
  </style>
</head>
<body>
  <header>
    <h1>Tutoriel React, Redux & Vite</h1>
    <p>Guide d'installation et d'utilisation</p>
  </header>
  <div class="container" id="tutorial-container"></div>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/prism.js"></script>
  <script>
document.addEventListener("DOMContentLoaded", async () => {
  const container = document.getElementById("tutorial-container");

  // Charger les données depuis le fichier tuto.json
  const response = await fetch("tuto.json");
  const sections = await response.json();

  // Générer dynamiquement le contenu
  sections.forEach((section) => {
    const sectionElement = document.createElement("div");
    sectionElement.classList.add("section");

    let codeContent = "";

    if (section.codeBlocks.length > 1 && section.liste === true) {
      // Si plusieurs blocs de code et la clé "liste" est true, générer une liste ul
      codeContent = `
        <ul>
          ${section.codeBlocks
            .map(
              (block) => `
                <li>
                  <strong>${block.label || "Code"}</strong>
                  <div class="code-block">
                    <pre><code class="language-${block.language}">${escapeHTML(
                      block.code
                    )}</code></pre>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                  </div>
                </li>
              `
            )
            .join("")}
        </ul>
      `;
    } else {
      // Sinon, afficher les blocs individuellement
      codeContent = section.codeBlocks
        .map(
          (block) => `
            <strong>${block.label || ""}</strong>
            <div class="code-block">
              
              <pre><code class="language-${block.language}">${escapeHTML(
            block.code
          )}</code></pre>
              <button class="copy-btn" onclick="copyCode(this)">Copier</button>
            </div>
          `
        )
        .join("");
    }

    sectionElement.innerHTML = `
      <h2>${section.title}</h2>
      <p>${section.description}</p>
      ${codeContent}
    `;

    container.appendChild(sectionElement);
  });

  // Appliquer la coloration syntaxique
  Prism.highlightAll();
});

// Fonction pour copier le contenu du code
function copyCode(button) {
  const codeElement = button.previousElementSibling;
  const textToCopy = codeElement.textContent || codeElement.innerText;

  const tempInput = document.createElement("textarea");
  document.body.appendChild(tempInput);
  tempInput.value = textToCopy;
  tempInput.select();
  document.execCommand("copy");
  document.body.removeChild(tempInput);

  button.textContent = "Copié!";
  setTimeout(() => (button.textContent = "Copier"), 1500);
}

// Fonction pour échapper les caractères spéciaux dans le code
function escapeHTML(str) {
  return str
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;");
}

  </script>
</body>
</html>
